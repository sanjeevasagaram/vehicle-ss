<!DOCTYPE html>
<html lang="en" class="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PrimeAuto | Service Management System</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        slate: {
                            850: '#151e2e',
                            900: '#0f172a',
                        },
                        primary: {
                            500: '#3b82f6',
                            600: '#2563eb',
                        }
                    }
                }
            }
        }
    </script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap');
        body { font-family: 'Inter', sans-serif; }
        .fade-in { animation: fadeIn 0.3s ease-in-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        /* Custom Scrollbar */
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #1e293b; }
        ::-webkit-scrollbar-thumb { background: #475569; border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: #64748b; }
    </style>
</head>
<body class="bg-slate-900 text-slate-100 h-screen flex flex-col overflow-hidden">

    <nav class="bg-slate-850 border-b border-slate-700 px-6 py-4 flex justify-between items-center shadow-lg z-50">
        <div class="flex items-center gap-3">
            <div class="w-10 h-10 bg-primary-600 rounded-lg flex items-center justify-center text-white font-bold text-xl shadow-lg shadow-primary-500/20">
                <i class="fa-solid fa-screwdriver-wrench"></i>
            </div>
            <h1 class="text-xl font-bold tracking-tight text-white">Prime<span class="text-primary-500">Auto</span></h1>
        </div>
        <div id="navButtons" class="hidden flex gap-4">
            <span id="welcomeMsg" class="self-center text-slate-400 text-sm mr-4"></span>
            <button onclick="logout()" class="text-sm font-medium text-slate-400 hover:text-white transition-colors">
                <i class="fa-solid fa-right-from-bracket mr-1"></i> Logout
            </button>
        </div>
    </nav>

    <main class="flex-1 overflow-y-auto p-6 relative">
        
        <div id="toast" class="fixed top-20 right-5 bg-emerald-600 text-white px-6 py-3 rounded shadow-lg transform translate-x-full transition-transform duration-300 z-50">
            Action Successful
        </div>

        <section id="authSection" class="h-full flex items-center justify-center fade-in">
            <div class="bg-slate-800 p-8 rounded-2xl border border-slate-700 shadow-2xl w-full max-w-md">
                <div class="text-center mb-8">
                    <h2 class="text-2xl font-bold text-white mb-2">Welcome Back</h2>
                    <p class="text-slate-400 text-sm">Access the professional service portal</p>
                </div>
                
                <div class="flex bg-slate-700/50 p-1 rounded-lg mb-6">
                    <button onclick="toggleAuth('login')" id="tabLogin" class="flex-1 py-2 text-sm font-medium rounded-md bg-slate-600 text-white shadow transition-all">Login</button>
                    <button onclick="toggleAuth('register')" id="tabRegister" class="flex-1 py-2 text-sm font-medium rounded-md text-slate-400 hover:text-white transition-all">Register</button>
                </div>

                <form id="loginForm" onsubmit="handleLogin(event)" class="space-y-4">
                    <div>
                        <label class="block text-xs font-semibold text-slate-400 uppercase tracking-wider mb-1">Email</label>
                        <input type="email" id="loginEmail" class="w-full bg-slate-900 border border-slate-700 rounded-lg px-4 py-2.5 text-white focus:outline-none focus:border-primary-500 transition-colors" placeholder="admin@prime.com" required>
                    </div>
                    <div>
                        <label class="block text-xs font-semibold text-slate-400 uppercase tracking-wider mb-1">Password</label>
                        <input type="password" class="w-full bg-slate-900 border border-slate-700 rounded-lg px-4 py-2.5 text-white focus:outline-none focus:border-primary-500 transition-colors" placeholder="••••••••" required>
                    </div>
                    <button type="submit" class="w-full bg-primary-600 hover:bg-primary-500 text-white font-semibold py-2.5 rounded-lg transition-all shadow-lg shadow-primary-600/20">Sign In</button>
                    <p class="text-xs text-center text-slate-500 mt-4">Demo Admin: admin@prime.com | User: user@gmail.com</p>
                </form>

                <form id="registerForm" onsubmit="handleRegister(event)" class="space-y-4 hidden">
                    <div>
                        <label class="block text-xs font-semibold text-slate-400 uppercase tracking-wider mb-1">Full Name</label>
                        <input type="text" id="regName" class="w-full bg-slate-900 border border-slate-700 rounded-lg px-4 py-2.5 text-white focus:outline-none focus:border-primary-500" required>
                    </div>
                    <div>
                        <label class="block text-xs font-semibold text-slate-400 uppercase tracking-wider mb-1">Email</label>
                        <input type="email" id="regEmail" class="w-full bg-slate-900 border border-slate-700 rounded-lg px-4 py-2.5 text-white focus:outline-none focus:border-primary-500" required>
                    </div>
                    <button type="submit" class="w-full bg-emerald-600 hover:bg-emerald-500 text-white font-semibold py-2.5 rounded-lg transition-all">Create Account</button>
                </form>
            </div>
        </section>

        <section id="customerDashboard" class="hidden max-w-6xl mx-auto space-y-8 fade-in">
            <div class="flex justify-between items-end border-b border-slate-700 pb-4">
                <div>
                    <h2 class="text-3xl font-bold text-white">My Garage</h2>
                    <p class="text-slate-400">Manage your vehicles and service history.</p>
                </div>
                <button onclick="openModal('addVehicleModal')" class="bg-primary-600 hover:bg-primary-500 text-white px-5 py-2.5 rounded-lg font-medium text-sm flex items-center gap-2 transition-all">
                    <i class="fa-solid fa-plus"></i> Add Vehicle
                </button>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                <div class="bg-slate-800 p-6 rounded-xl border border-slate-700">
                    <div class="text-slate-400 text-sm font-medium">Total Vehicles</div>
                    <div class="text-3xl font-bold text-white mt-2" id="statVehicles">0</div>
                </div>
                <div class="bg-slate-800 p-6 rounded-xl border border-slate-700">
                    <div class="text-slate-400 text-sm font-medium">Active Services</div>
                    <div class="text-3xl font-bold text-emerald-400 mt-2" id="statActive">0</div>
                </div>
                <div class="bg-slate-800 p-6 rounded-xl border border-slate-700">
                    <div class="text-slate-400 text-sm font-medium">Completed Services</div>
                    <div class="text-3xl font-bold text-blue-400 mt-2" id="statCompleted">0</div>
                </div>
            </div>

            <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                <div class="lg:col-span-1 space-y-4">
                    <h3 class="text-lg font-semibold text-white">Select Vehicle to Book</h3>
                    <div id="vehicleListContainer" class="space-y-3">
                        </div>
                </div>

                <div class="lg:col-span-2 space-y-4">
                    <h3 class="text-lg font-semibold text-white">Service History & Status</h3>
                    <div class="bg-slate-800 rounded-xl border border-slate-700 overflow-hidden">
                        <table class="w-full text-left text-sm text-slate-400">
                            <thead class="bg-slate-700/50 text-slate-200 uppercase text-xs">
                                <tr>
                                    <th class="px-6 py-3">Vehicle</th>
                                    <th class="px-6 py-3">Service Type</th>
                                    <th class="px-6 py-3">Date</th>
                                    <th class="px-6 py-3">Status</th>
                                </tr>
                            </thead>
                            <tbody id="customerHistoryTable" class="divide-y divide-slate-700">
                                </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </section>

        <section id="adminDashboard" class="hidden max-w-7xl mx-auto space-y-6 fade-in">
            <div class="flex justify-between items-center border-b border-slate-700 pb-4">
                <div>
                    <h2 class="text-3xl font-bold text-white">Admin Console</h2>
                    <p class="text-slate-400">Monitor bookings and update workflow.</p>
                </div>
                <div class="bg-slate-800 px-4 py-2 rounded-lg border border-slate-700">
                    <span class="text-slate-400 text-xs uppercase tracking-widest font-bold">Total Revenue (Est)</span>
                    <div class="text-xl font-bold text-emerald-400">$12,450.00</div>
                </div>
            </div>

            <div class="bg-slate-800 rounded-xl border border-slate-700 shadow-xl overflow-hidden">
                <div class="p-6 border-b border-slate-700 flex justify-between items-center">
                    <h3 class="font-semibold text-white">All Service Requests</h3>
                    <input type="text" placeholder="Search ID or Name..." class="bg-slate-900 border border-slate-600 rounded-lg px-3 py-1 text-sm text-white focus:outline-none">
                </div>
                <div class="overflow-x-auto">
                    <table class="w-full text-left text-sm text-slate-400">
                        <thead class="bg-slate-700/50 text-slate-200 uppercase text-xs">
                            <tr>
                                <th class="px-6 py-4">ID</th>
                                <th class="px-6 py-4">Customer</th>
                                <th class="px-6 py-4">Vehicle Details</th>
                                <th class="px-6 py-4">Service</th>
                                <th class="px-6 py-4">Status</th>
                                <th class="px-6 py-4 text-right">Actions</th>
                            </tr>
                        </thead>
                        <tbody id="adminBookingTable" class="divide-y divide-slate-700">
                            </tbody>
                    </table>
                </div>
            </div>
        </section>

    </main>

    <div id="addVehicleModal" class="fixed inset-0 bg-black/70 hidden items-center justify-center z-50 backdrop-blur-sm">
        <div class="bg-slate-800 rounded-xl border border-slate-700 p-6 w-full max-w-sm shadow-2xl">
            <h3 class="text-xl font-bold text-white mb-4">Add New Vehicle</h3>
            <form onsubmit="handleAddVehicle(event)" class="space-y-3">
                <input type="text" id="vName" placeholder="Car Name (e.g. BMW X5)" class="w-full bg-slate-900 border border-slate-600 rounded px-3 py-2 text-white" required>
                <input type="text" id="vPlate" placeholder="License Plate" class="w-full bg-slate-900 border border-slate-600 rounded px-3 py-2 text-white" required>
                <div class="flex justify-end gap-2 mt-4">
                    <button type="button" onclick="closeModal('addVehicleModal')" class="px-4 py-2 text-slate-300 hover:text-white">Cancel</button>
                    <button type="submit" class="bg-primary-600 hover:bg-primary-500 text-white px-4 py-2 rounded-lg">Add Vehicle</button>
                </div>
            </form>
        </div>
    </div>

    <div id="bookServiceModal" class="fixed inset-0 bg-black/70 hidden items-center justify-center z-50 backdrop-blur-sm">
        <div class="bg-slate-800 rounded-xl border border-slate-700 p-6 w-full max-w-sm shadow-2xl">
            <h3 class="text-xl font-bold text-white mb-2">Book Service</h3>
            <p id="bookModalVehicleName" class="text-slate-400 text-sm mb-4"></p>
            <form onsubmit="handleBookService(event)" class="space-y-3">
                <input type="hidden" id="bookVehicleId">
                <select id="serviceType" class="w-full bg-slate-900 border border-slate-600 rounded px-3 py-2 text-white" required>
                    <option value="General Service">General Service ($150)</option>
                    <option value="Oil Change">Oil Change ($50)</option>
                    <option value="Brake Repair">Brake Repair ($200)</option>
                    <option value="Engine Diagnostics">Engine Diagnostics ($80)</option>
                </select>
                <input type="date" id="serviceDate" class="w-full bg-slate-900 border border-slate-600 rounded px-3 py-2 text-white" required>
                <div class="flex justify-end gap-2 mt-4">
                    <button type="button" onclick="closeModal('bookServiceModal')" class="px-4 py-2 text-slate-300 hover:text-white">Cancel</button>
                    <button type="submit" class="bg-primary-600 hover:bg-primary-500 text-white px-4 py-2 rounded-lg">Confirm Booking</button>
                </div>
            </form>
        </div>
    </div>

    <script>
        // --- DATA MOCKUP ---
        let currentUser = null;
        
        // Initial Dummy Data
        const db = {
            users: [
                { id: 1, name: "Admin User", email: "admin@prime.com", role: "admin" },
                { id: 2, name: "John Doe", email: "user@gmail.com", role: "customer" }
            ],
            vehicles: [
                { id: 101, userId: 2, name: "Tesla Model 3", plate: "KL-08-BQ-1234" },
                { id: 102, userId: 2, name: "Ford Mustang", plate: "KL-07-AZ-9999" }
            ],
            bookings: [
                { id: 5001, userId: 2, vehicleId: 101, vehicleName: "Tesla Model 3", service: "General Service", date: "2023-11-20", status: "Completed" },
                { id: 5002, userId: 2, vehicleId: 102, vehicleName: "Ford Mustang", service: "Oil Change", date: "2023-12-01", status: "Pending" }
            ]
        };

        // --- AUTHENTICATION ---
        function toggleAuth(type) {
            const loginForm = document.getElementById('loginForm');
            const regForm = document.getElementById('registerForm');
            const tabLogin = document.getElementById('tabLogin');
            const tabRegister = document.getElementById('tabRegister');

            if(type === 'login') {
                loginForm.classList.remove('hidden');
                regForm.classList.add('hidden');
                tabLogin.classList.replace('text-slate-400', 'text-white');
                tabLogin.classList.replace('bg-transparent', 'bg-slate-600');
                tabRegister.classList.replace('bg-slate-600', 'bg-transparent');
                tabRegister.classList.add('text-slate-400');
            } else {
                loginForm.classList.add('hidden');
                regForm.classList.remove('hidden');
                tabRegister.classList.replace('text-slate-400', 'text-white');
                tabRegister.classList.replace('bg-transparent', 'bg-slate-600');
                tabLogin.classList.replace('bg-slate-600', 'bg-transparent');
                tabLogin.classList.add('text-slate-400');
            }
        }

        function handleLogin(e) {
            e.preventDefault();
            const email = document.getElementById('loginEmail').value;
            // Simple mock login
            const user = db.users.find(u => u.email === email);
            
            if (user) {
                currentUser = user;
                initApp();
            } else {
                alert("Invalid Credentials. Try admin@prime.com or user@gmail.com");
            }
        }

        function handleRegister(e) {
            e.preventDefault();
            const name = document.getElementById('regName').value;
            const email = document.getElementById('regEmail').value;
            
            const newUser = { id: Date.now(), name, email, role: 'customer' };
            db.users.push(newUser);
            currentUser = newUser;
            showToast("Account Created Successfully");
            initApp();
        }

        function logout() {
            currentUser = null;
            document.getElementById('authSection').classList.remove('hidden');
            document.getElementById('customerDashboard').classList.add('hidden');
            document.getElementById('adminDashboard').classList.add('hidden');
            document.getElementById('navButtons').classList.add('hidden');
            document.getElementById('loginEmail').value = '';
        }

        // --- DASHBOARD LOGIC ---
        function initApp() {
            // Hide Auth
            document.getElementById('authSection').classList.add('hidden');
            document.getElementById('navButtons').classList.remove('hidden');
            document.getElementById('navButtons').classList.add('flex');
            document.getElementById('welcomeMsg').innerText = `Hello, ${currentUser.name}`;

            if(currentUser.role === 'admin') {
                renderAdminDashboard();
            } else {
                renderCustomerDashboard();
            }
        }

        // --- CUSTOMER FUNCTIONS ---
        function renderCustomerDashboard() {
            document.getElementById('customerDashboard').classList.remove('hidden');
            
            // 1. Render Vehicles
            const vContainer = document.getElementById('vehicleListContainer');
            vContainer.innerHTML = '';
            const myVehicles = db.vehicles.filter(v => v.userId === currentUser.id);
            
            document.getElementById('statVehicles').innerText = myVehicles.length;

            if(myVehicles.length === 0) {
                vContainer.innerHTML = `<div class="p-4 text-center text-slate-500 border border-dashed border-slate-700 rounded-lg">No vehicles found. Add one!</div>`;
            } else {
                myVehicles.forEach(v => {
                    vContainer.innerHTML += `
                        <div class="bg-slate-800 p-4 rounded-lg border border-slate-700 flex justify-between items-center group hover:border-primary-500 transition-colors">
                            <div>
                                <h4 class="font-bold text-white">${v.name}</h4>
                                <span class="text-xs text-slate-400 bg-slate-900 px-2 py-1 rounded">${v.plate}</span>
                            </div>
                            <button onclick="openBookModal(${v.id}, '${v.name}')" class="text-sm bg-slate-700 hover:bg-primary-600 text-white px-3 py-1.5 rounded transition-colors">
                                Book
                            </button>
                        </div>
                    `;
                });
            }

            // 2. Render History & Stats
            renderCustomerHistory();
        }

        function renderCustomerHistory() {
            const tableBody = document.getElementById('customerHistoryTable');
            tableBody.innerHTML = '';
            
            const myBookings = db.bookings.filter(b => b.userId === currentUser.id);
            
            // Update Stats
            const active = myBookings.filter(b => b.status !== 'Completed').length;
            const completed = myBookings.filter(b => b.status === 'Completed').length;
            document.getElementById('statActive').innerText = active;
            document.getElementById('statCompleted').innerText = completed;

            myBookings.forEach(b => {
                let statusColor = getStatusColor(b.status);
                tableBody.innerHTML += `
                    <tr>
                        <td class="px-6 py-4 font-medium text-white">${b.vehicleName}</td>
                        <td class="px-6 py-4">${b.service}</td>
                        <td class="px-6 py-4 text-slate-500">${b.date}</td>
                        <td class="px-6 py-4"><span class="${statusColor} px-2 py-1 rounded text-xs font-bold">${b.status}</span></td>
                    </tr>
                `;
            });
        }

        function handleAddVehicle(e) {
            e.preventDefault();
            const name = document.getElementById('vName').value;
            const plate = document.getElementById('vPlate').value;
            
            db.vehicles.push({
                id: Date.now(),
                userId: currentUser.id,
                name: name,
                plate: plate
            });
            
            closeModal('addVehicleModal');
            showToast('Vehicle Added');
            renderCustomerDashboard();
            e.target.reset();
        }

        function handleBookService(e) {
            e.preventDefault();
            const vId = document.getElementById('bookVehicleId').value;
            const vehicleObj = db.vehicles.find(v => v.id == vId);
            const service = document.getElementById('serviceType').value;
            const date = document.getElementById('serviceDate').value;

            db.bookings.push({
                id: Date.now(),
                userId: currentUser.id,
                vehicleId: vId,
                vehicleName: vehicleObj.name,
                service: service,
                date: date,
                status: 'Pending'
            });

            closeModal('bookServiceModal');
            showToast('Service Booked Successfully');
            renderCustomerDashboard();
        }

        // --- ADMIN FUNCTIONS ---
        function renderAdminDashboard() {
            document.getElementById('adminDashboard').classList.remove('hidden');
            const tableBody = document.getElementById('adminBookingTable');
            tableBody.innerHTML = '';

            db.bookings.forEach(b => {
                const customer = db.users.find(u => u.id === b.userId);
                
                // Dropdown logic
                let statusOptions = '';
                ['Pending', 'In Progress', 'Completed'].forEach(opt => {
                    const selected = b.status === opt ? 'selected' : '';
                    statusOptions += `<option value="${opt}" ${selected}>${opt}</option>`;
                });

                tableBody.innerHTML += `
                    <tr class="hover:bg-slate-700/30 transition-colors">
                        <td class="px-6 py-4 text-slate-500">#${b.id.toString().slice(-4)}</td>
                        <td class="px-6 py-4 font-medium text-white">${customer.name}</td>
                        <td class="px-6 py-4">
                            <div class="font-bold text-slate-200">${b.vehicleName}</div>
                            <div class="text-xs text-slate-500">${b.service}</div>
                        </td>
                        <td class="px-6 py-4 text-slate-400">${b.service}</td>
                        <td class="px-6 py-4">
                             <select onchange="updateStatus(${b.id}, this.value)" class="bg-slate-900 border border-slate-600 text-xs rounded px-2 py-1 text-white focus:border-primary-500 focus:outline-none">
                                ${statusOptions}
                             </select>
                        </td>
                        <td class="px-6 py-4 text-right">
                            <button class="text-slate-400 hover:text-white"><i class="fa-solid fa-ellipsis-vertical"></i></button>
                        </td>
                    </tr>
                `;
            });
        }

        function updateStatus(bookingId, newStatus) {
            const booking = db.bookings.find(b => b.id === bookingId);
            if(booking) {
                booking.status = newStatus;
                showToast(`Status updated to ${newStatus}`);
                // Re-render handled automatically by select change visually, but good to refresh data logic
            }
        }

        // --- UTILS ---
        function getStatusColor(status) {
            if(status === 'Pending') return 'bg-yellow-500/20 text-yellow-500';
            if(status === 'In Progress') return 'bg-blue-500/20 text-blue-500';
            if(status === 'Completed') return 'bg-emerald-500/20 text-emerald-500';
            return 'bg-slate-700 text-slate-300';
        }

        function openModal(id) {
            document.getElementById(id).classList.remove('hidden');
            document.getElementById(id).classList.add('flex');
        }

        function closeModal(id) {
            document.getElementById(id).classList.add('hidden');
            document.getElementById(id).classList.remove('flex');
        }

        function openBookModal(vId, vName) {
            document.getElementById('bookVehicleId').value = vId;
            document.getElementById('bookModalVehicleName').innerText = `Booking for: ${vName}`;
            openModal('bookServiceModal');
        }

        function showToast(msg) {
            const toast = document.getElementById('toast');
            toast.innerText = msg;
            toast.classList.remove('translate-x-full');
            setTimeout(() => {
                toast.classList.add('translate-x-full');
            }, 3000);
        }

    </script>
</body>
</html>
